<div
class="w-full sm:w-10/12 lg:w-8/12 bg-white p-4 rounded-lg shadow-xl mb-4"
>
  <div class="flex items-center justify-between mb-2">
    <%= link_to user_path(user) do %>
      <div class="flex items-center gap-4">
        <%= image_tag user.profile_pic_url, class: "w-14 h-14 rounded-full" %>
        <span class="font-medium text-xl"
    ><%= user.first_name %> <%= user.last_name %></span
  >
      </div>
    <% end %>
    <div>
      <% isRequestedFromThem = FriendRequest.where(sent_user: user, received_user: current_user) %>
      <% isRequestedFromMe = FriendRequest.where(sent_user: current_user, received_user: user) %>
      <% noRequest = FriendRequest.where(sent_user: current_user, received_user: user) %>
      <% if isRequestedFromThem.exists? %>
        <%= form_with url: friend_request_path(isRequestedFromThem.first.id), method: :patch do |f| %>
          <%= f.hidden_field :friend_id, value: user.id %>
          <%= f.submit "Accept Request" %>
        <% end %>
      <% elsif isRequestedFromMe.exists? %>
        <%= form_with url: friend_request_path(isRequestedFromMe.first.id), method: :delete do |f| %>
          <%= f.hidden_field :friend_id, value: user.id %>
          <%= f.submit "Cancel Request" %>
        <% end %>
      <% elsif !user.friends.include?(current_user) && !noRequest.exists? %>
        <%= form_with url: friend_requests_path do |f| %>
          <%= f.hidden_field :friend_id, value: user.id %>
          <%= f.submit "Send friend request" %>
        <% end %>
      <% end %>
    </div>
  </div>
</div>
